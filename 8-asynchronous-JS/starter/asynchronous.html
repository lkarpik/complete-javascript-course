<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Asynchronous JavaScript</title>
</head>

<body>
    <h1>Asynchronous JavaScript</h1>
    <script>
        /* 
        const first = (name) => {

            setTimeout(() => {

                console.log(`Hello there ${name}`);

            }, 1000)

        };

        const second = () => {
            console.log(`Starting second`);
            first(`form first function`);
            console.log(`End second`);

        };

        second();
        */

        /* 
        function getRecipe() {
        setTimeout(() => {

        const recipes = [
            `Burger`,
            `Ham`,
            `Chicken`
        ];
        console.log(recipes);

        setTimeout(id => {

            const recipe = {
                title: id,
                recipe: `Go to mcDonald`,
                author: `Lucky Luck`
            }
            console.log(recipe);

            setTimeout(author => {

                const recipe2 = {
                    title: `Chicken`,
                    recipe: `Be fast`,
                    autor: author
                }
                console.log(recipe2);

            }, 1000, recipe.author);

        }, 1000, recipes[0]);

        }, 1000);
        };

        getRecipe();
        */


        // const testPromice = new Promise((resolve, reject) => {
        //     setTimeout(() => {
        //         resolve([123, 234, 345, 456])
        //     }, 1500)
        // });

        // testPromice.then(res => {
        //     console.log(`From test promice`);
        //     console.log(res);
        // }).catch(err => {
        //     console.log(err);
        // })


        // getIDs = new Promise((resolve, reject) => {
        //     setTimeout(() => {
        //         resolve([123, 234, 345, 456])
        //     }, 1500)
        // });

        // getRecipe = (recipeID) => {
        //     return new Promise((resolve, reject) => {
        //         setTimeout(id => {
        //             const recipe = {
        //                 title: id,
        //                 recipe: `Go to mcDonald`,
        //                 author: `Lucky Luck`
        //             };
        //             resolve(recipe)
        //         }, 1500, recipeID)
        //     });
        // };
        // // **** !!!! chaining promices with await !!!! ****
        // async function getRecipesAW() {
        //     const IDs = await getIDs;
        //     console.log(IDs);
        //     const recipe = await getRecipe(IDs[1]);
        //     // console.log(recipe);
        //     return recipe;
        // }

        // // getRecipesAW();

        // getRecipesAW().then(result => {
        //     console.log(`From getRecipesAW`);
        //     console.log(result.author);
        // });

        // async function getResult() {
        //     let result = await getRecipesAW();
        //     console.log(`From get Result`);
        //     console.log(result.author);
        // }
        // getResult();

        // AJAX

        // let data = fetch('https://jsonplaceholder.typicode.com/todos/').then(data => {
        //         console.log(data);
        //         return data.json();
        //     }).then(data => {
        //         console.log(data);
        //         let completed = data.reduce((acc, el) => {
        //             return acc + (el.completed ? 1 : 0);
        //         }, 0);
        //         console.log(completed);
        //     })
        //     .catch(err => console.log(err));

        let asyncTodos = async () => {

            try {
                let data = await fetch('https://jsonplaceholder.typicode.com/todos/');

                data = await data.json();

                let newData = data.map(el => {
                    if (el.completed) {
                        el.title = "Zrobione :)"
                        return el;
                    } else {
                        el.title = "Co do HUJA!";
                        return el;
                    }
                });

                console.log(newData);
                return data;
            } catch (error) {
                console.log(error);
            }
        };

        // Get the data outside Promice
        let asyncData;
        asyncTodos().then(data => asyncData = data);
    </script>
</body>

</html>